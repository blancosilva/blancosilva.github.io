<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Searching for the SS Central America</title>
    <meta name="description" content="Useless math is useful math. It can be used to generate more useless math.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://yourdomain.com/articles/2014/10/30/searching-for-the-ss-central-america.html">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Francisco Blanco-Silva</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About me</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/presentations.html">Presentations</a>
          
        
          
          <a class="page-link" href="/resume.html">Résumé</a>
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Searching for the SS Central America</h1>
    <p class="post-meta">Oct 30, 2014 • Francisco Blanco-Silva</p>
  </header>

  <article class="post-content">
    <p style="text-align:center;"><img src="https://farm6.staticflickr.com/5582/15072819006_39df81b2a6_d.jpg" style="width:100%; border:2px solid black;" /></p>

<p>On Tuesday, September 8th 1857, the steamboat SS Central America left Havana at 9 AM for New York, carrying about 600 passengers and crew members.   Inside of this vessel, there was stowed a very precious cargo: a set of manuscripts by John James Audubon, and three tons of gold bars and coins.  The manuscripts documented an expedition through the yet uncharted southwestern United States and California, and contained 200 sketches and paintings of its wildlife.  The gold, fruit of many years of prospecting and mining during the California Gold Rush, was meant to start anew the lives of many of the passengers aboard.</p>

<p>On the 9th, the vessel ran into a storm which developed into a hurricane.  The steamboat endured four hard days at sea, and by Saturday morning the ship was doomed.  The captain arranged to have women and children taken off to the brig Marine, which offered them assistance at about noon.  In spite of the efforts of the remaining crew and passengers to save the ship, the inevitable happened at about 8 PM that same day.  The wreck claimed the lives of 425 men, and carried the valuable cargo to the bottom of the sea.</p>

<p>It was not until late 1980s that technology allowed recovery of shipwrecks at deep sea.  But no technology would be of any help without an accurate location of the site.  In the following paragraphs we would like to illustrate the power of the <code>scipy</code> stack by performing a simple simulation, that ultimately creates a dataset of possible locations for the wreck of the SS Central America, and mines the data to attempt to pinpoint the most probable target.</p>

<p>We simulate several possible paths of the steamboat (say 10,000 randomly generated possibilities), between 7:00 AM on Saturday, and 13 hours later, at 8:00 pm on Sunday. At 7:00 AM on that Saturday the ship’s captain, William Herndon, took a celestial fix and verbally relayed the position to the schooner <em>El Dorado</em>.  The fix was 31º25’ North, 77º10’ West.  Because the ship was not operative at that point—no engine, no sails—, for the next thirteen hours its course was solely subjected to the effect of ocean current and winds.  With enough information, it is possible to model the drift and leeway on different possible paths.</p>

<p>We start by creating a <strong>data frame</strong>—a computational structure that will hold all the values we need in a very efficient way.  We do so with the help of the <code>pandas</code> libraries.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse</span><span class="p">(</span><span class="s">&quot;9/12/1857 7 am&quot;</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">interval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">herndon</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">interval</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;Lat&#39;</span><span class="p">,</span> <span class="s">&#39;Lon&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">14</span><span class="p">])</span></code></pre></div>

<p>Each column of the data frame <code>herndon</code> is to hold the latitude and longitude of a possible path of the SS Central America, sampled every hour. Let us populate this data following a similar analysis to the one followed by the Columbus America Discovery Group, as explained by Lawrence D. Stone in the article <a href="http://ieeexplore.ieee.org/xpl/abstractAuthors.jsp?arnumber=5712111"><em>Revisiting the SS Central America Search</em></a>, from the 2010 Conference on Information Fusion.</p>

<p>The celestial fix obtained by Capt. Herndon at 7:00 AM was taken with a sextant in the middle of a storm.  There are some uncertainties in the estimation of latitude and longitude with this method and under those weather conditions, which are modeled by a bivariate normally distributed random variable with mean (0,0) and standard deviations of 0.9 nautical miles (for latitude), and 3.9 nautical miles (for longitude).  We create first a random variable with those characteristics.  Let us use this idea to populate the dataframe with several random initial locations.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multivariate_normal</span>
<span class="n">celestial_fix</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">)))</span></code></pre></div>

<p>To estimate the corresponding celestial fixes, as well as all further geodetic computations, we will use the accurate <a href="en.wikipedia.org/wiki/Vincenty's_formulae">formulas of Vincenty for ellipsoids</a>, assuming a radius at the Equator of \(a = 63781374\) meters, and a flattening of the ellipsoid of \(f = 1/298.257223563\) (these figures are regarded as one of the standards for use in cartography, geodesy and navigation, and are referred by the community as the <a href="http://en.wikipedia.org/wiki/World_Geodetic_System">World Geodetic System WGS-84 ellipsoid</a>)</p>

<p>A very good set of Vincenty’s formulas coded in <code>python</code> can be found at <a href="http://wegener.mechanik.tu-darmstadt.de/GMT-Help/Archiv/att-8710/Geodetic_py">wegener.mechanik.tu-darmstadt.de/GMT-Help/Archiv/att-8710/Geodetic_py</a>.</p>

<p>In particular, for this example we will be using <em>Vincenty’s direct formula</em>, that computes the resulting latitude \(\phi_2\), longitude \(\lambda_2\), and azimuth \(\alpha_2\) of an object starting at latitude \(\phi_1\), longitude \(\lambda_1\), and traveling \(s\) meters with initial azimuth \(\alpha_1\).  Latitudes, longitudes and azimuths are given in degrees, and distances in meters.  We also use the convention of assigning negative values to the latitudes to the West.  To apply the conversion from nautical miles or knots to their respective units in SI, we employ the system of units in <code>scipy.constants</code>.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">Geodetic_py</span> <span class="kn">import</span> <span class="n">vinc_pt</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">nautical_mile</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">6378137.0</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">298.257223563</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">lat_delta</span><span class="p">,</span> <span class="n">lon_delta</span> <span class="o">=</span> <span class="n">celestial_fix</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span> <span class="o">*</span> <span class="n">nautical_mile</span>
    <span class="n">azimuth</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">lat_delta</span> <span class="o">+</span> <span class="mi">1j</span><span class="o">*</span><span class="n">lon_delta</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">lat_delta</span><span class="p">,</span> <span class="n">lon_delta</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">vinc_pt</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">31</span><span class="o">+</span><span class="mf">25.</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">77</span><span class="o">-</span><span class="mf">10.</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>
    <span class="n">herndon</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;1857-09-12 07:00:00&#39;</span><span class="p">,:][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span></code></pre></div>

<p>Issuing now the command <code>herndon.ix['1857-09-12 07:00:00',:]</code> gives us the following output:</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">--------------------------------------------------------------------------------</span>
<span class="go">          0          1          2          3          4          5     \</span>
<span class="go">Lat  31.455345  31.452572  31.439491  31.444000  31.462029  31.406287</span>
<span class="go">Lon -77.148860 -77.168941 -77.173416 -77.163484 -77.169911 -77.168462   </span>
<span class="go">          6          7          8          9       ...           9990  \</span>
<span class="go">Lat  31.390807  31.420929  31.441248  31.367623    ...      31.405862</span>
<span class="go">Lon -77.178367 -77.187680 -77.176924 -77.172941    ...     -77.146794   </span>
<span class="go">          9991       9992       9993       9994       9995       9996  \</span>
<span class="go">Lat  31.394365  31.428827  31.415392  31.443225  31.350158  31.392087</span>
<span class="go">Lon -77.179720 -77.182885 -77.159965 -77.186102 -77.183292 -77.168586   </span>
<span class="go">          9997       9998       9999</span>
<span class="go">Lat  31.443154  31.438852  31.401723</span>
<span class="go">Lon -77.169504 -77.151137 -77.134298  </span>
<span class="go">[2 rows x 10000 columns]</span>
<span class="go">--------------------------------------------------------------------------------</span></code></pre></div>

<p>We simulate the drift according to the formula \(D = (V + \gamma W)\).  In this formula \(V\) (the ocean current) is modeled as vector pointing about North-East (around 45 degrees of azimuth) and a variable speed between 1 and 1.5 knots. The other random variable, \(W\), represents the action of the winds in the area during the hurricane, which we choose to represent by directions ranging between South and East, and speeds with a mean 0.2 knots, standard deviation 1/30 knots. Both random variables are coded as bivariate normal.  Finally, we have accounted for the leeway factor.  According to a study performed on the blueprints of the SS Central America, we have estimated this leeway \(\gamma\) to be about 3%.</p>

<p>This choice of random variables to represent the ocean current and wind differs from the ones used in the aforementioned paper.  In our version we have not used the actual covariance matrices as computed by Stone from data received from the Naval Oceanographic Data Center.  Rather, we have presented a very simplified version.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">current</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">),</span> <span class="n">cov</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">270</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="o">/</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">wind</span>    <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">),</span> <span class="n">cov</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">30</span><span class="p">)))</span>
<span class="n">leeway</span>  <span class="o">=</span> <span class="mf">3.</span><span class="o">/</span><span class="mi">100</span>
<span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s">&#39;1857-9-12 08:00:00&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">&#39;1h&#39;</span><span class="p">):</span>
    <span class="n">before</span>  <span class="o">=</span> <span class="n">herndon</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">date</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
        <span class="n">angle</span><span class="p">,</span> <span class="n">speed</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
        <span class="n">current_v</span> <span class="o">=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">nautical_mile</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
        <span class="n">angle</span><span class="p">,</span> <span class="n">speed</span>  <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span>
        <span class="n">wind_v</span> <span class="o">=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">nautical_mile</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
        <span class="n">drift</span> <span class="o">=</span> <span class="n">current_v</span> <span class="o">+</span> <span class="n">leeway</span> <span class="o">*</span> <span class="n">wind_v</span>
        <span class="n">azimuth</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">drift</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">drift</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">vinc_pt</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">before</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;Lat&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">before</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;Lon&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>
        <span class="n">herndon</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">date</span><span class="p">,:][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span></code></pre></div>

<p>Let us plot the first three of those simulated paths:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span> 
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlon</span><span class="o">=-</span><span class="mf">77.4</span><span class="p">,</span> <span class="n">llcrnrlat</span><span class="o">=</span><span class="mf">31.2</span><span class="p">,</span> <span class="n">urcrnrlon</span><span class="o">=-</span><span class="mf">76.6</span><span class="p">,</span>
            <span class="n">urcrnrlat</span><span class="o">=</span><span class="mf">31.8</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;lcc&#39;</span><span class="p">,</span> <span class="n">lat_0</span> <span class="o">=</span> <span class="mf">31.5</span><span class="p">,</span>
            <span class="n">lon_0</span><span class="o">=-</span><span class="mi">77</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="n">area_thresh</span><span class="o">=</span><span class="mf">1000.</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">77.4</span><span class="p">,</span><span class="o">-</span><span class="mf">76.6</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">31.2</span><span class="p">,</span><span class="mf">32.8</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">]</span>
<span class="n">styles</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">longitudes</span> <span class="o">=</span> <span class="n">herndon</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span><span class="s">&#39;Lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">latitudes</span>  <span class="o">=</span> <span class="n">herndon</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span><span class="s">&#39;Lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></div>

<p style="text-align:center;"><img src="https://farm4.staticflickr.com/3846/14908975489_c8628da777_z_d.jpg" style="width:75%;" /></p>

<p>As expected they observe a North-Easterly general direction, in occasion showing deviations from the effect of the strong winds.</p>

<p>The advantage of storing all the different steps in these paths becomes apparent if we need to perform some further study—and maybe filtering—on the data obtained.  We could impose additional conditions to paths, and use only those filtered according to the extra rules, for example.  Another advantage is the possibility of performing different analysis on the paths with very little coding.  By issuing the command <code>herndon.loc(axis=0)[:,'Lat'].describe()</code>, we obtain quick statistics on the computed latitudes for all 10000 paths (number of items, mean, standard deviation, min, max and the quartiles of the data).</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">--------------------------------------------------------------------------------</span>
<span class="go">            0          1          2          3          4          5     \</span>
<span class="go">count  14.000000  14.000000  14.000000  14.000000  14.000000  14.000000</span>
<span class="go">mean   31.474706  31.489831  31.479797  31.551953  31.543533  31.516511</span>
<span class="go">std     0.058218   0.060026   0.060504   0.060204   0.060290   0.065008</span>
<span class="go">min    31.388410  31.400693  31.387974  31.457087  31.446786  31.421331</span>
<span class="go">25%    31.431773  31.439437  31.429712  31.506764  31.498132  31.465424</span>
<span class="go">50%    31.470768  31.491100  31.481918  31.551521  31.546649  31.510613</span>
<span class="go">75%    31.515063  31.541353  31.527317  31.599800  31.588251  31.568368</span>
<span class="go">max    31.571535  31.580176  31.575999  31.641745  31.639944  31.619281   </span>
<span class="go">            6          7          8          9       ...           9990  \</span>
<span class="go">count  14.000000  14.000000  14.000000  14.000000    ...      14.000000</span>
<span class="go">mean   31.463063  31.515181  31.510682  31.448281    ...      31.541765</span>
<span class="go">std     0.064530   0.060904   0.064621   0.061350    ...       0.059633</span>
<span class="go">min    31.369973  31.410879  31.412623  31.353806    ...      31.445757</span>
<span class="go">25%    31.410827  31.473212  31.460292  31.398931    ...      31.500659</span>
<span class="go">50%    31.460968  31.516328  31.511749  31.448647    ...      31.542774</span>
<span class="go">75%    31.512171  31.565814  31.555854  31.492793    ...      31.583822</span>
<span class="go">max    31.564134  31.601316  31.620487  31.547686    ...      31.632320   </span>
<span class="go">            9991       9992       9993       9994       9995       9996  \</span>
<span class="go">count  14.000000  14.000000  14.000000  14.000000  14.000000  14.000000</span>
<span class="go">mean   31.481608  31.501862  31.509630  31.495412  31.557487  31.491508</span>
<span class="go">std     0.064426   0.061343   0.057857   0.068578   0.058520   0.055164</span>
<span class="go">min    31.384021  31.398002  31.408542  31.387861  31.452803  31.402979</span>
<span class="go">25%    31.422987  31.457732  31.468419  31.440465  31.518770  31.450746</span>
<span class="go">50%    31.489742  31.509546  31.515301  31.503460  31.565790  31.493993</span>
<span class="go">75%    31.532992  31.549224  31.553803  31.545975  31.596499  31.532340</span>
<span class="go">max    31.576120  31.589048  31.591815  31.599973  31.645622  31.577492   </span>
<span class="go">            9997       9998       9999</span>
<span class="go">count  14.000000  14.000000  14.000000</span>
<span class="go">mean   31.522756  31.509904  31.461305</span>
<span class="go">std     0.055411   0.064045   0.066058</span>
<span class="go">min    31.435634  31.408430  31.363115</span>
<span class="go">25%    31.482015  31.458449  31.405953</span>
<span class="go">50%    31.523253  31.519991  31.463235</span>
<span class="go">75%    31.567399  31.555133  31.516251</span>
<span class="go">max    31.605647  31.605175  31.556127  </span>
<span class="go">[8 rows x 10000 columns]</span>
<span class="go">--------------------------------------------------------------------------------</span></code></pre></div>

<p>The focus of this simulation is, nonetheless, on the final location of all these paths.  Let us plot them all on the same map first, for a quick visual evaluation.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">latitudes</span><span class="p">,</span> <span class="n">longitudes</span> <span class="o">=</span> <span class="n">herndon</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;1857-9-12 20:00:00&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlon</span><span class="o">=-</span><span class="mf">82.</span><span class="p">,</span> <span class="n">llcrnrlat</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="n">urcrnrlon</span><span class="o">=-</span><span class="mi">76</span><span class="p">,</span>
            <span class="n">urcrnrlat</span><span class="o">=</span><span class="mf">32.5</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&#39;lcc&#39;</span><span class="p">,</span> <span class="n">lat_0</span> <span class="o">=</span> <span class="mf">31.5</span><span class="p">,</span>
            <span class="n">lon_0</span><span class="o">=-</span><span class="mi">78</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s">&#39;h&#39;</span><span class="p">,</span> <span class="n">area_thresh</span><span class="o">=</span><span class="mf">1000.</span><span class="p">)</span>
<span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="o">-</span><span class="mf">81.2003759</span><span class="p">,</span> <span class="mf">32.0405369</span><span class="p">)</span>  <span class="c"># Coordinates of Savannah, GA</span>
<span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">longitudes</span><span class="p">,</span> <span class="n">latitudes</span><span class="p">,</span> <span class="s">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">10000</span><span class="p">,</span> <span class="s">&#39;Savannah, GA&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">82</span><span class="p">,</span><span class="o">-</span><span class="mi">76</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mf">32.5</span><span class="p">,</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;coral&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">drawmapboundary</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></div>

<p style="text-align:center;"><img src="https://farm4.staticflickr.com/3901/14909109417_304514a8ae_c_d.jpg" style="width:100%;" /></p>

  </article>

<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'eseprimo'; 

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>


<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Francisco Blanco-Silva</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Francisco Blanco-Silva</li>
          <li><a href="mailto:francisco.blanco.silva@gmail.com">francisco.blanco.silva@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/blancosilva">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">blancosilva</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/eseprimo">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">eseprimo</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Useless math is useful math. It can be used to generate more useless math.
</p>
      </div>
    </div>

  </div>

</footer>


    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56262970-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>

</html>
