<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width initial-scale=1">
	<meta name="description" content="Useless math is useful math. It can be used to generate more useless math.
">
	<meta name="author" content="">

	<title>Apollonian gaskets and circle inversion fractals</title>

	<!-- Bootstrap core CSS -->
	<link href="/css/bootstrap.css" rel="stylesheet">
	<!-- Bootstrap theme -->
	<link href="/css/bootstrap-theme.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="/css/blog.css" rel="stylesheet">
	<link rel="stylesheet" href="/css/pygments.css">
</head>

<body role="document">

	<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<a class="navbar-brand" href="#">
				<img alt="Brand" src="https://farm6.staticflickr.com/5131/5393012839_cf3ccae561_o_d.png" style="width:25px;">
			</a>
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
			</button>
			<a class="navbar-brand" href="/">Francisco Blanco-Silva</a>
		</div>
		<div id="navbar" class="navbar-collapse collapse">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				
				
				<li><a class="page-link" href="/about/">About me</a></li>
				
				
				
				<li><a class="page-link" href="/books/">Books</a></li>
				
				
				
				
				
				
				
				
				
				
				
				<li><a class="page-link" href="/presentations.html">Presentations</a></li>
				
				
				
				
				
				
			</ul> <!-- nav navbar-nav -->
			<ul class="nav navbar-nav navbar-right">
				<li class="dropdown">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown">Teaching <span class="caret"></span></a>
					<ul class="dropdown-menu" role="menu">
						<li class="dropdown-header">Current | Most recent classes</li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li><a href="/course/2014/08/19/ma141-fall-2014.html">MA141—Fall 2014</a></li>
						
						
						
						<li><a href="/course/2014/08/18/math-122-fall-2014.html">MA122—Fall 2014</a></li>
						
						
						
						
						
						
						
						
						
						
						
						<li><a href="/course/2014/01/11/ma-241-spring-2014.html">MA241—Spring 2014</a></li>
						
						
						
						
						
						
						
						
						
						<li><a href="/course/2013/08/22/ma242-fall-2013.html">MA242—Fall 2013</a></li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li><a href="/course/2012/06/26/ma142-summer-ii-2012.html">MA142—Summer II 2012</a></li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li class="divider"></li>
						<li class="dropdown-header">Review Exams</li>
						
						
						<li><a href="/forum/2014/12/01/MA122Fa14RT3.html">MATH 122 Fall 2014 Review Exam (3|4)</a></li>
						
						
						
						<li><a href="/forum/2014/12/01/MA122Fa14RT1.html">MATH 122 Fall 2014 Review Exam (1|4)</a></li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li class="divider"></li>
						<li class="dropdown-header">Selected Class Material</li>
						
						
						
						
						
						
						<li><a href="/teaching/2014/11/08/past-classes.html">Past Sections of Undergraduate Calculus</a></li>
						
						
						
						<li><a href="/teaching/2014/11/08/Mathematical-Imaging.html">Mathematical Imaging</a></li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li><a href="/teaching/2010/10/27/an-introduction-to-algebraic-topology.html">An Introduction to Algebraic Topology</a></li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li><a href="/teaching/2010/09/24/distributions.html">Introduction to the Theory of Distributions</a></li>
						
						
						
						
						
						<li><a href="/teaching/2010/07/08/ma598r.html">MA598R—Summer 2007</a></li>
						
						
						
						
						
						
						
						
					</ul>
				</li> <!-- dropdown -->
			</ul>
		</div><!--/.nav-collapse -->
	</div>
</nav>



	<div class="page-content">
		<div class="wrapper">
			<br />
<br />
<br />
<br />
<div class="container theme-showcase" role="main" style="font-size:16px; font-family: Helvetica; width:750px;">

	<header class="post-header">
		<h1 class="post-title">Apollonian gaskets and circle inversion fractals</h1>
		<p class="post-meta">Jan 30, 2011</p>
	</header>

	<article class="post-content">
		<p>Recall the definition of an <a>iterated function system</a> (IFS), and how on occasion, their attractors are fractal sets.  What happens when we allow more general functions instead of mere affine maps?</p>

<p>The key to the design of this amazing fractal is in the notion of limit sets of circle inversions.</p>

<p>The definition of inversion <span>\( f_C \colon \mathbb{C} \to \mathbb{C} \)</span> with respect to a circle <span>\( C \)</span> with center <span>\( \boldsymbol{c} \in \mathbb{C} \)</span> and radius <span>\( r&gt;0 \)</span> depends on the location of <span>\( z\in \mathbb{C} \)</span> with respect to the circle:</p>

<ul>
  <li>Given any point <span>\( z\in \mathbb{C} \)</span> outside of the disk bounded by <span>\( C, \)</span> consider the segment that joins <span>\( \boldsymbol{c} \)</span> with <span>\( z, \)</span>  and the only circle that has this segment as diameter.  The two circles intersect at points <span>\( P, Q. \)</span>  The intersection of the segments <span>\( PQ \)</span> and <span>\( \boldsymbol{c}z \)</span> is the inversion of <span>\( z\colon \)</span></li>
</ul>

<p style="text-align:center;"><img src="http://farm6.static.flickr.com/5056/5409962710_a6b3f40783_b_d.jpg" alt="" width="100%" /></p>

<ul>
  <li>The inversion of a point <span>\( z \)</span> inside the disk bounded by <span>\( C \)</span> is obtained in a similar fashion: Consider the ray originating at <span>\( \boldsymbol{c} \)</span> that goes through <span>\( z, \)</span> and its perpendicular through <span>\( z. \)</span>  The latter intersects the circle <span>\( C \)</span> at points <span>\( P,Q. \)</span> The only circle that goes through <span>\( \boldsymbol{c}, P \)</span> and <span>\( Q \)</span> intersects the ray <span>\( \boldsymbol{c}z \)</span> at the inversion of <span>\( z. \)</span></li>
  <li>For any point <span>\( z \)</span> in the circle <span>\( C, \)</span> it is <span>\( f_C(z)=z. \)</span></li>
</ul>

<p>Note that the circle inversion is an <em>involution</em>: <span>\( \big( f_C\circ f_C\big) (z) = z \)</span> for all <span>\( z \in \mathbb{C}. \)</span>  One must therefore be careful when designing IFS’s with inversions; usually we include a mechanism that prevents such a map to be called twice on a row.</p>

<p>Let us examine a few basic examples:</p>

<h2 id="an-ifs-consisting-on-circle-inversions-with-respect-to-two-disjoint-disks">An IFS consisting on circle inversions with respect to two disjoint disks</h2>

<p>Choose two disjoint disks, construct an IFS containing the two corresponding circle inversions, pick a random point outside the two disks, and compute the orbit of this point by mapping each output  through alternate inversions (in order to avoid the involution producing infinite loops).  As you can see in the figure below, the limit seems to be a very simple set: two points.  Can you find their location analytically?</p>

<p style="text-align:center;"><img src="http://farm6.static.flickr.com/5219/5417488786_c2b8c0d7ea_b_d.jpg" alt="" width="75%" /></p>

<p>How will the attractor set change if the two disks are tangent?  And if the two disks intersect at a larger set?</p>

<h2 id="an-ifs-consisting-on-circle-inversions-with-respect-to-three-mutually-disjoint-disks">An IFS consisting on circle inversions with respect to three mutually disjoint disks</h2>

<p>We obtain our first fractal: It has the structure of a <a href="http://blancosilva.wordpress.com/puzzles/the-cantor-set/">Cantor set</a>, supported on a circle.  Can you find the center and radius of that circle?</p>

<p style="text-align:center;"><img src="http://farm6.static.flickr.com/5011/5417585504_ecfd3beb63_b_d.jpg" alt="" width="75%" /></p>

<h2 id="an-ifs-consisting-on-circle-inversions-with-respect-to-five-mutually-disjoint-disks">An IFS consisting on circle inversions with respect to five mutually disjoint disks</h2>

<p>This is when the fun starts.  Do the attractors for the circle inversion of these two examples with five disks look familiar?</p>

<p style="text-align:center;"><img src="http://farm6.static.flickr.com/5011/5417122261_82bdd121f7_b_d.jpg" alt="" width="75%" /></p>
<p style="text-align:center;"><img src="http://farm6.static.flickr.com/5216/5417180059_84144f7810_b_d.jpg" width="75%" /></p>

<h2 id="miscellaneous">Miscellaneous</h2>

<p>The question is, how many disks, and which configuration must they observe so that the corresponding attractor is a proper Apollonian gasket?  (a fractal generated from triples of circles, where each circle is tangent to the other two)</p>

<p>Let us go one step further, and allow in the IFS more general Möbius transformations.   For example, a (modified) IFS with the three maps <span>\( f_1, f_2 \)</span> and <span>\( f_3 \)</span> defined below, offers a possible solution:</p>

<div>
\begin{equation}
 f_1(z) =  \frac{3}{ 1+\sqrt{3}-z }-\frac{1+\sqrt{3}}{2+\sqrt{3}},\quad f_2(z) = \big( -1+i\sqrt{3}\big) f_1(z),\quad f_3(z)=\big( -1 -i\sqrt{3}\big)f_1(z) 
 \end{equation}
</div>

<p style="text-align:center;"><img src="http://farm6.static.flickr.com/5291/5409859530_44b4f4f792_b_d.jpg" alt="" width="80%" /></p>

<p>A naïve code to obtain this fractal is shown:  Note that we have not included any mechanism to prevent any inversion to repeat itself in consecutive steps—that way we do not avoid having points that go back and forth through the same circle inversion.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="lineno"> 2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span> <span class="k">def</span> <span class="nf">ifms</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
<span class="lineno"> 5</span>     <span class="n">location</span><span class="o">=</span><span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">i</span>
<span class="lineno"> 6</span>     <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="p">[],[]</span>
<span class="lineno"> 7</span>     <span class="n">s</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="lineno"> 8</span> 
<span class="lineno"> 9</span> <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
<span class="lineno">10</span>         <span class="n">location</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">s</span><span class="o">-</span><span class="n">location</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">s</span><span class="p">)</span>
<span class="lineno">11</span>         <span class="n">choice</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="lineno">12</span>         <span class="k">if</span> <span class="n">choice</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
<span class="lineno">13</span>             <span class="n">location</span><span class="o">=</span><span class="n">f1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="lineno">14</span>         <span class="k">elif</span> <span class="n">choice</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
<span class="lineno">15</span>             <span class="n">location</span><span class="o">=</span><span class="n">f1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="lineno">16</span>         <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">float32</span><span class="p">(</span><span class="n">location</span><span class="o">.</span><span class="n">real</span><span class="p">()))</span>
<span class="lineno">17</span>         <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">float32</span><span class="p">(</span><span class="n">location</span><span class="o">.</span><span class="n">imag</span><span class="p">()))</span>
<span class="lineno">18</span>     <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span>
<span class="lineno">19</span> 
<span class="lineno">20</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="lineno">21</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
<span class="lineno">22</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="n">ifms</span><span class="p">(</span><span class="mi">400000</span><span class="p">)</span>
<span class="lineno">23</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="s">&#39;.k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="lineno">24</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;/Users/blanco/Desktop/pointplot.png&#39;</span><span class="p">)</span></code></pre></div>


	</article>

	
	<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'blancosilva'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

	
</div>


<script type="text/javascript"
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

		</div>
	</div>

	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56262970-1', 'auto');
  ga('send', 'pageview');

</script>
	<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10117038; 
var sc_invisible=1; 
var sc_security="1fd852f3"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="free hit
counters" href="http://statcounter.com/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/10117038/0/1fd852f3/1/"
alt="free hit counters"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
</body>
</html>
